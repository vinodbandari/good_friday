/*! dialogs-manager v3.0.0 | (c) Kobi Zaltzberg | https://github.com/cobicarmel/dialogs-manager/blob/master/LICENSE.txt */
!function(u,t){"use strict";var g={widgetsTypes:{},createWidgetType:function(t,e,n){n||(n=this.Widget);var i=function(){n.apply(this,arguments)},o=i.prototype=new n(t);return u.extend(o,e),(o.constructor=i).extend=function(t,e){return g.createWidgetType(t,e,i)},i},addWidgetType:function(t,e,n){return e&&e.prototype instanceof this.Widget?this.widgetsTypes[t]=e:this.widgetsTypes[t]=this.createWidgetType(t,e,n)},getWidgetType:function(t){return this.widgetsTypes[t]}};g.Instance=function(){var i=this,n={},o={};this.createWidget=function(t,e){var n=new(g.getWidgetType(t))(t);return e=e||{},n.init(i,e),n.setMessage(e.message),n},this.getSettings=function(t){return t?o[t]:Object.create(o)},this.init=function(t){var e;return e=t,o=u.extend({classPrefix:"dialog",effects:{show:"fadeIn",hide:"fadeOut"}},e),n.body=u("body"),i},i.init()},g.Widget=function(o){var s=this,a={},r={},c={},n=function(t){var e=a.effects[t],n=c.widget;if(u.isFunction(e))e.call(n);else{if(!n[e])throw"Reference Error: The effect "+e+" not found";n[e]()}},d=function(){var t=s.getSettings();u.each(t,function(t){var e=t.match(/^on([A-Z].*)/);e&&(e=e[1].charAt(0).toLowerCase()+e[1].slice(1),s.on(e,this))})};this.addElement=function(t,e,n){var i=c[t]=u(e||"<div>"),o=a.classes.prefix+"-";return o+=t=t.replace(/([a-z])([A-Z])/g,function(){return arguments[1]+"-"+arguments[2].toLowerCase()}),n||(n=t),o+=" "+a.classes.globalPrefix+"-"+n,i.addClass(o),i},this.getSettings=function(t){var e=Object.create(a);return t?e[t]:e},this.init=function(t,e){if(!(t instanceof g.Instance))throw"The "+s.widgetName+" must to be initialized from an instance of DialogsManager.Instance";return s.trigger("init",e),function(t,e){var n=t.getSettings();(a=s.getDefaultSettings()).effects=n.effects;var i=n.classPrefix+"-"+o;a.classes={globalPrefix:n.classPrefix,prefix:i,widget:"dialog-widget"},u.extend(!0,a,e),d()}(t,e),function(){s.addElement("widget"),s.addElement("message");var t=s.getSettings("id");t&&s.getElements("widget").attr("id",t)}(),s.buildWidget(),s.attachEvents&&s.attachEvents(),s.trigger("ready"),s},this.getElements=function(t){return t?c[t]:c},this.hide=function(){return n("hide"),s.trigger("hide"),s},this.on=function(t,e){return r[t]||(r[t]=[]),r[t].push(e),s},this.setMessage=function(t){return c.message.html(t),s},this.show=function(t,e){return t&&t.stopPropagation(),c.widget.appendTo("body"),n("show"),s.trigger("show",e),s},this.trigger=function(t,n){var e="on"+t[0].toUpperCase()+t.slice(1);s[e]&&s[e](n);var i=r[t];i&&u.each(i,function(t,e){e.call(s,n)})}},g.Widget.prototype.buildWidget=function(){var t=this.getElements();t.widget.html(t.message)},g.Widget.prototype.getDefaultSettings=function(){return{}},g.Widget.prototype.onHide=function(){},g.Widget.prototype.onShow=function(){},g.Widget.prototype.onInit=function(){},g.Widget.prototype.onReady=function(){},g.addWidgetType("options",{activeKeyUp:function(t){9===t.which&&t.preventDefault(),this.hotKeys[t.which]&&this.hotKeys[t.which](this)},activeKeyDown:function(t){if(9===t.which){t.preventDefault();var e,n=this.focusedButton.index();t.shiftKey?(e=n-1)<0&&(e=this.buttons.length-1):(e=n+1)>=this.buttons.length&&(e=0),this.focusedButton=this.buttons[e].focus()}},addButton:function(t){var e=this,n=e.addElement(t.name,u("<button>").text(t.text));e.buttons.push(n);var i=function(){e.getSettings("hideOnButtonClick")&&e.hide(),u.isFunction(t.callback)&&t.callback.call(this,e)};return n.on("click",i),t.hotKey&&(this.hotKeys[t.hotKey]=i),this.getElements("buttonsWrapper").append(n),t.focus&&(this.focusedButton=n),e},bindHotKeys:function(){this.getElements("window").on({keyup:this.activeKeyUp,keydown:this.activeKeyDown})},buildWidget:function(){this.addElement("window",window);var t=this.addElement("widgetHeader"),e=this.addElement("widgetContent"),n=this.addElement("buttonsWrapper"),i=this.getElements();e.append(t,i.message,n),i.widget.html(e)},ensureClosureMethods:function(){var e=this;u.each(["placeWidget","activeKeyUp","activeKeyDown"],function(){var t=e[this];e[this]=function(){t.apply(e,arguments)}})},getDefaultSettings:function(){return{position:{my:"center",at:"center center-100"},headerMessage:"",hideOnButtonClick:!0,refreshPosition:!0}},onHide:function(){this.unbindHotKeys(),this.getElements("window").off("resize",this.placeWidget)},onInit:function(){this.ensureClosureMethods(),this.buttons=[],this.hotKeys={},this.focusedButton=null},onReady:function(){this.setHeaderMessage(this.getSettings("headerMessage"))},onShow:function(t){var e=this;e.placeWidget(t),e.getSettings("refreshPosition")&&e.getElements("window").on("resize",e.placeWidget),e.bindHotKeys(),e.focusedButton||(e.focusedButton=e.buttons[0]),e.focusedButton&&e.focusedButton.focus()},placeWidget:function(t){var e=this.getElements(),n=this.getSettings("position");n.of=e.widget,t&&u.extend(n,t),e.widgetContent.position(n)},setHeaderMessage:function(t){return this.getElements("widgetHeader").html(t),this},unbindHotKeys:function(){this.getElements("window").off({keyup:this.activeKeyUp,keydown:this.activeKeyDown})}}),g.addWidgetType("confirm",g.getWidgetType("options").extend("confirm",{onReady:function(){g.getWidgetType("options").prototype.onReady.apply(this,arguments);var t=this.getSettings("strings"),e="cancel"===this.getSettings("defaultOption");this.addButton({name:"cancel",text:t.cancel,callback:function(t){t.trigger("cancel")},hotKey:27,focus:e}),this.addButton({name:"ok",text:t.confirm,callback:function(t){t.trigger("confirm")},focus:!e})},getDefaultSettings:function(){var t=g.getWidgetType("options").prototype.getDefaultSettings.apply(this,arguments);return t.strings={confirm:"OK",cancel:"Cancel"},t.defaultOption="cancel",t}})),g.addWidgetType("alert",g.getWidgetType("options").extend("alert",{onReady:function(){g.getWidgetType("options").prototype.onReady.apply(this,arguments);var t=this.getSettings("strings");this.addButton({name:"ok",text:t.confirm,callback:function(t){t.trigger("confirm")}})},getDefaultSettings:function(){var t=g.getWidgetType("options").prototype.getDefaultSettings.apply(this,arguments);return t.strings={confirm:"OK"},t}})),g.addWidgetType("popup",{getDefaultSettings:function(){return{position:{my:"center",at:"center",of:window},hide:{delay:5e3}}},onShow:function(){this.getElements("message").position(this.getSettings("position")),setTimeout(this.hide,this.getSettings("hide").delay)}}),t.DialogsManager=g}("function"==typeof require?require("jquery"):jQuery,"undefined"!=typeof module?module.exports:window);